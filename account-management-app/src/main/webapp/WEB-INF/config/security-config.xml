<beans:beans
  xmlns="http://www.springframework.org/schema/security"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:beans="http://www.springframework.org/schema/beans"
  xmlns:mvc="http://www.springframework.org/schema/mvc"
  xsi:schemaLocation="
           http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
           http://www.springframework.org/schema/security
           http://www.springframework.org/schema/security/spring-security-3.0.xsd
           http://www.springframework.org/schema/mvc
           http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd"

>

  <beans:bean
    id="accessDecisionManager"
    class="org.springframework.security.access.vote.UnanimousBased"
  >
    <beans:property
      name="decisionVoters"
    >
      <beans:list>
        <beans:bean
          id="roleVoter"
          class="org.springframework.security.access.vote.RoleHierarchyVoter"
        >
          <beans:constructor-arg
            ref="roleHierarchy" />
        </beans:bean>
      </beans:list>
    </beans:property>
  </beans:bean>
  
    <beans:bean
    id="roleHierarchy"
    class="org.springframework.security.access.hierarchicalroles.RoleHierarchyImpl"
  >
    <beans:property
      name="hierarchy"
    >
      <beans:value> ROLE_ROOT > ROLE_OWNER ROLE_OWNER > ROLE_ADMIN ROLE_ADMIN > ROLE_USER ROLE_USER > ROLE_ANONYMOUS</beans:value>
    </beans:property>
  </beans:bean>
  
  
  
<http auto-config="false" >
    <access-denied-handler error-page="/app/access-denied"/>
    <intercept-url
      pattern="/app/accounts/new"
      access="ROLE_USER" />
    <intercept-url
      pattern="/app/accounts/byid/**"
      access="ROLE_USER" />
    <intercept-url
      pattern="/app/users/byid/**"
      access="ROLE_USER" />
    <form-login
      login-page="/app/login"
      always-use-default-target="false"
      login-processing-url="/app/j_spring_security_check"
      authentication-failure-url="/app/login?error=true" />
    <http-basic />
    <logout invalidate-session="true"  logout-url="/app/j_spring_security_logout"/>
  </http>


  <!-- AuthN Manager -->
  <authentication-manager
    alias="authenticationManager"
  >
    <authentication-provider
      user-service-ref="userDetailsService" />
  </authentication-manager>

  <global-method-security  pre-post-annotations="enabled" 
      
  >
    <!-- 
    <protect-pointcut 
      expression="execution(* org.duracloud.account.util.Root*Service.*(..))"
      access="ROLE_ROOT" />
    <protect-pointcut 
      expression="execution(* org.duracloud.account.util.Root*Service.*(..))"
      access="ROLE_ROOT" />
    <protect-pointcut
      expression="execution(* org.duracloud.account.util.Account*Service.*(..))"
      access="ROLE_USER"  />
    <protect-pointcut
      expression="execution(* org.duracloud.account.util.Account*Service.*(..))"
      access="ROLE_USER"  />
  -->
    
  </global-method-security>

</beans:beans>