<?xml version="1.0" encoding="UTF-8"?>
<beans 
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns="http://www.springframework.org/schema/beans"
  xmlns:webflow="http://www.springframework.org/schema/webflow-config"
  xsi:schemaLocation="
           http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
	      http://www.springframework.org/schema/webflow-config
	      http://www.springframework.org/schema/webflow-config/spring-webflow-config-2.0.xsd">
  <!--  web flow configuration -->
  <bean id="flowController" class="org.springframework.webflow.mvc.servlet.FlowController">
    <property name="flowExecutor" ref="flowExecutor" />
  </bean>
  
  <webflow:flow-executor id="flowExecutor" flow-registry="flowRegistry" />

  
  <webflow:flow-registry id="flowRegistry" flow-builder-services="flowBuilderServices">
	<webflow:flow-location id="spaces/add"  path="/WEB-INF/config/flows/add-space-flow.xml" />
	<webflow:flow-location id="contents/add"  path="/WEB-INF/config/flows/add-content-item-flow.xml" />
  </webflow:flow-registry>
  
  <bean class="org.springframework.webflow.mvc.servlet.FlowHandlerAdapter">
    <property name="flowExecutor" ref="flowExecutor" />
  </bean>
  
  
  <bean class="org.springframework.webflow.mvc.servlet.FlowHandlerMapping">
    <property name="flowRegistry" ref="flowRegistry"/>
    <property name="order" value="0"/>
  </bean>
  
    <!-- Plugs in a custom creator for Web Flow views -->
  <webflow:flow-builder-services id="flowBuilderServices"
          view-factory-creator="mvcViewFactoryCreator" conversion-service="conversionService" development="true" />

  <bean id="conversionService"
        class="org.duracloud.duradmin.binding.ConversionService"/>

  <!-- Configures Web Flow to use Tiles to create views for rendering; Tiles allows for applying consistent layouts to your views -->
  <bean id="mvcViewFactoryCreator"
        class="org.springframework.webflow.mvc.builder.MvcViewFactoryCreator">
      <property name="viewResolvers" ref="tilesViewResolver" />
  </bean>

  <!-- add space configuration --> 
  <bean name="spaces/add" class="org.duracloud.duradmin.control.AddSpaceFlowHandler" />
  <bean name="addSpaceAction" class="org.duracloud.duradmin.webflow.space.AddSpaceAction">
  	<property name="contentStoreProvider" ref="contentStoreProvider"/>
  </bean>
  <bean name="spaceValidator" class="org.duracloud.duradmin.webflow.space.SpaceValidator">
  	<property name="contentStoreProvider" ref="contentStoreProvider"/>
  </bean>

  <!-- add content configuration --> 
  <bean name="contents/add" class="org.duracloud.duradmin.control.AddContentItemFlowHandler">
  	<property name="contentStoreProvider" ref="contentStoreProvider"/>
  </bean>
  <bean name="addContentItemAction" class="org.duracloud.duradmin.webflow.content.AddContentItemAction">
  	<property name="contentStoreProvider" ref="contentStoreProvider"/>
  </bean>
  <bean name="contentItemValidator" class="org.duracloud.duradmin.webflow.content.ContentItemValidator">
  	<property name="contentStoreProvider" ref="contentStoreProvider"/>
  </bean>

</beans>